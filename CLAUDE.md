# Инструкции для ИИ-ассистентов

> Этот файл содержит правила для Claude и других ИИ-ассистентов при работе с кодовой базой AIST Track Bot.

---

## Обязательные правила

### 1. Терминология

**ВСЕГДА используй термины из [docs/ontology.md](docs/ontology.md).**

Перед началом работы:
1. Прочитай `docs/ontology.md`
2. Используй только термины из этого документа
3. Не придумывай новые термины

При неясности:
- **Спроси пользователя**, а не придумывай сам
- Пример: "Ты имеешь в виду Урок (теория Марафона) или Дайджест (материал Ленты)?"

### 2. Краткая справка по терминам

| Термин | Что это |
|--------|---------|
| **Ученик** | Пользователь Марафона |
| **Читатель** | Пользователь Ленты |
| **Марафон** | 14-дневная программа |
| **Лента** | Гибкое обучение по дайджестам |
| **Урок** | Теория в Марафоне (материал + вопрос) |
| **Задание** | Практика в Марафоне |
| **Дайджест** | Ежедневный материал в Ленте |
| **Фиксация** | Личный вывод Читателя |
| **Сложность** | Уровень вопросов (1-3) |

### 3. Соответствие кода и терминов

При работе с кодом учитывай, что текущие имена в коде отличаются от терминологии:

| Термин | В коде сейчас | Целевое имя |
|--------|---------------|-------------|
| Урок | `theory` | `lesson` |
| Материал урока | `theory content` | `lesson_text` |
| Задание | `practice` | `task` |
| Материал задания | `practice content` | `task_text` |
| Дайджест | `feed_session`, `content` | `digest` |
| Вопрос урока | `question` | `lesson_question` |
| Фиксация | `fixation` | `fixation` |
| Сложность | `bloom_level` | `complexity` |

---

## Типы сообщений бота

### Сообщения бота

| Тип | Подтип | Описание |
|-----|--------|----------|
| **Материал** | Материал урока | Теоретический текст (Марафон) |
| **Материал** | Материал задания | Текст инструкции к практике (Марафон) |
| **Материал** | Дайджест | Ежедневный текст (Лента) |
| **Вопрос** | Вопрос урока | Проверка понимания теории |
| **Вопрос** | Бонусный вопрос | Повышенная сложность |
| **Вопрос** | Вопрос дайджеста | Для фиксации (Лента) |
| **Обратная связь** | Проверка | Комментарий к ответу |
| **Обратная связь** | Подсказка | Помощь при затруднении |
| **Запрос** | Запрос данных | Имя, язык и т.п. |
| **Запрос** | Меню тем | Выбор тем на неделю |
| **Сводка** | Профиль | Информация о пользователе |
| **Сводка** | Статистика | Прогресс |
| **Служебное** | Подтверждение | "Принято", "Генерирую..." |
| **Служебное** | Ошибка | Сообщение об ошибке |

### Сообщения пользователя

| Тип | Подтип | Описание |
|-----|--------|----------|
| **Ответ** | Ответ на урок | На вопрос теории |
| **Ответ** | Ответ на задание | Описание рабочего продукта |
| **Ответ** | Ответ на бонус | На бонусный вопрос |
| **Ответ** | Фиксация | Личный вывод (Лента) |
| **Ответ** | Вопрос пользователя | Запрос помощи |

---

## Структура проекта

```
aist_track_bot/
├── bot.py                    # Марафон: обработчики, генерация
├── engines/
│   └── feed/                 # Лента
│       ├── engine.py         # Генерация дайджестов
│       ├── handlers.py       # Обработчики команд
│       └── planner.py        # Планирование недели
├── db/
│   ├── models.py             # SQLAlchemy модели
│   └── queries/              # SQL-запросы
├── config/
│   └── settings.py           # Настройки, константы
├── docs/
│   └── ontology.md           # ТЕРМИНОЛОГИЯ (источник истины)
├── knowledge_structure.yaml  # Структура тем Марафона
├── locales.py                # Переводы интерфейса
└── CLAUDE.md                 # Этот файл
```

---

## Правила разработки

### При изменении терминологии

1. Сначала обнови `docs/ontology.md`
2. Получи подтверждение от пользователя
3. Затем меняй код

### При добавлении нового типа сообщения

1. Определи, к какому основному типу относится (Материал, Вопрос, Обратная связь и т.д.)
2. Добавь в `docs/ontology.md`
3. Спроси пользователя, если не уверен в классификации

### При написании сообщений пользователю

- Используй русские термины из онтологии
- Пример: "Урок", не "теория" или "тема"
- Пример: "Дайджест", не "контент" или "сессия"

### При написании кода

- Используй английские эквиваленты из таблицы соответствия
- Добавляй комментарии с русскими терминами при необходимости

---

## Частые ошибки

| Неправильно | Правильно |
|-------------|-----------|
| "контент" (в Ленте) | Дайджест |
| "тема" (как единица обучения) | Урок / Задание / Дайджест |
| "сессия" | Дайджест (Лента) или День (Марафон) |
| "вопрос для размышления" | Вопрос урока / Вопрос дайджеста |
| "рефлексия" | Фиксация |
| "уровень Блума" | Сложность |
| "пользователь" (когда известен режим) | Ученик (Марафон) / Читатель (Лента) |

---

## Чеклист перед коммитом

- [ ] Термины соответствуют `docs/ontology.md`
- [ ] Новые сущности добавлены в онтологию
- [ ] Сообщения пользователю используют русские термины
- [ ] Код использует согласованные английские имена
